(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[952],{456:function(e,t,a){Promise.resolve().then(a.bind(a,5017))},6304:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"RouterContext",{enumerable:!0,get:function(){return s}});let r=a(1024),o=r._(a(2265)),s=o.default.createContext(null)},5017:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return MarketDetailsPage}});var r=a(7437),o=a(2265),s=a(4033),l=a(6454);let processMarketData=e=>(e.listing_id&&!e.id&&(e.id=e.listing_id),e.location_x&&"string"==typeof e.location_x&&(e.location_x=parseFloat(e.location_x)),e.location_y&&"string"==typeof e.location_y&&(e.location_y=parseFloat(e.location_y)),e.distance&&"string"==typeof e.distance&&(e.distance=parseFloat(e.distance)),e);async function getMarketDetails(e){try{console.log("Getting details for market ID:",e);let t="https://www.usdalocalfoodportal.com/api",a="wT29LlT8K9",r=["".concat(t,"/farmersmarket/").concat(e,"?apikey=").concat(a),"".concat(t,"/farmersmarket/").concat(e,"/?apikey=").concat(a)],o=null;for(let e=0;e<r.length;e++){let t=r[e];try{console.log("Trying market details URL format ".concat(e+1," (API key hidden):"),t.replace(a,"***API_KEY***"));let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!r.ok){console.log("Market details format ".concat(e+1," failed with status ").concat(r.status));continue}o=await r.json(),console.log("Market details format ".concat(e+1," succeeded!"),o);break}catch(t){console.error("Error with market details format ".concat(e+1,":"),t)}}if(!o){console.log("All direct formats failed, trying fetchMarketById as fallback");try{o=await (0,l.xL)(e),console.log("Fallback fetchMarketById response:",o)}catch(e){console.error("Fallback fetchMarketById failed:",e)}}return o?processMarketData(o):null}catch(e){return console.error("Error getting market details:",e),null}}var n=a(2410),i=a(9682);function MarketDetailsPage(){let e=(0,s.useSearchParams)(),t=(null==e?void 0:e.get("id"))||"",{getMarketById:a}=(0,i.useMarketData)(),[l,c]=(0,o.useState)(null),[d,u]=(0,o.useState)(!0),[h,g]=(0,o.useState)(null);(0,o.useEffect)(()=>{!async function(){if(!t){g("Market ID is required"),u(!1);return}try{u(!0),console.log("Fetching market with ID:",t);let e=a(t);if(console.log("Context market data:",e),e){console.log("Using market data from context storage"),c(e),g(null),u(!1);return}console.log("Market not found in context, trying API");let r=await getMarketDetails(t);if(console.log("Market details result:",r),console.log("MARKET API DATA (DETAILED):",JSON.stringify(r,null,2)),r)c(r),g(null);else{let e=getFallbackData(t);console.log("API returned no data, using fallback data:",e),c(e),g(null)}}catch(a){console.error("Error fetching market details:",a);let e=getFallbackData(t);e?(console.log("Using fallback data after error"),c(e),g(null)):g("Failed to fetch market details. Please try again.")}finally{u(!1)}}()},[t,a]);let getFallbackData=e=>({1000073:{id:"1000073",listing_id:"1000073",marketname:"Capitol Hill Farmers Market",Address:"200 North Capitol Street",city:"Washington",State:"DC",zip:"20001",Schedule:"Sunday, 9:00 AM - 1:00 PM",Products:"Vegetables, Fruits, Cheese, Baked goods",lat:38.8921,lon:-77.0096},1000078:{id:"1000078",listing_id:"1000078",marketname:"Union Square Greenmarket",Address:"1 Union Square West",city:"New York",State:"NY",zip:"10003",Schedule:"Monday, Wednesday, Friday, Saturday, 8:00 AM - 6:00 PM",Products:"Vegetables, Fruits, Meat, Dairy, Baked goods, Plants",lat:40.7359,lon:-73.9911},309254:{id:"309254",listing_id:"309254",marketname:"Portland Farmers Market",Address:"240 SW Yamhill St",city:"Portland",State:"OR",zip:"97204",Schedule:"Saturday, 8:30 AM - 2:00 PM",Products:"Local produce, Crafts, Food vendors",lat:45.5188,lon:-122.6756},"fallback-id":{id:"fallback-id",listing_id:"fallback-id",marketname:"Sample Farmers Market",Address:"123 Market Street",city:"Anytown",State:"US",zip:"12345",Schedule:"Saturday, 9:00 AM - 1:00 PM",Products:"Vegetables, Fruits, Baked goods",lat:40.7128,lon:-74.006}})[e]||{id:e,listing_id:e,marketname:"Farmers Market #".concat(e),Address:"123 Market Street",city:"Anytown",State:"US",zip:"12345",Schedule:"Saturday, 9:00 AM - 1:00 PM",Products:"Vegetables, Fruits, Baked goods",lat:40.7128,lon:-74.006,brief_desc:"This is a placeholder market entry for ID "+e},getMarketName=()=>l?l.listing_name||l.marketname||l.MarketName||"Farmers Market Details":"",getAddress=()=>{if(!l)return[];let e=[];if(l.location_address)e.push(l.location_address);else{l.Address&&e.push(l.Address),(l.street||l.location_street)&&e.push(l.street||l.location_street);let t="";(l.city||l.City||l.location_city)&&(t+=l.city||l.City||l.location_city),(l.state||l.State||l.location_state)&&t?t+=", ".concat(l.state||l.State||l.location_state):(l.state||l.State||l.location_state)&&(t+=l.state||l.State||l.location_state),(l.zip||l.Zip||l.location_zipcode)&&(t+=" ".concat(l.zip||l.Zip||l.location_zipcode)),t&&e.push(t)}return e},getProducts=()=>{if(!l)return[];if(l.Products)return l.Products.split(",").map(e=>e.trim());let e=[];return l.Organic&&"Y"===l.Organic&&e.push("Organic"),l.Bakedgoods&&"Y"===l.Bakedgoods&&e.push("Baked Goods"),l.Cheese&&"Y"===l.Cheese&&e.push("Cheese"),l.Crafts&&"Y"===l.Crafts&&e.push("Crafts"),l.Flowers&&"Y"===l.Flowers&&e.push("Flowers"),l.Eggs&&"Y"===l.Eggs&&e.push("Eggs"),l.Seafood&&"Y"===l.Seafood&&e.push("Seafood"),l.Herbs&&"Y"===l.Herbs&&e.push("Herbs"),l.Vegetables&&"Y"===l.Vegetables&&e.push("Vegetables"),l.Honey&&"Y"===l.Honey&&e.push("Honey"),l.Jams&&"Y"===l.Jams&&e.push("Jams"),l.Meat&&"Y"===l.Meat&&e.push("Meat"),l.Nuts&&"Y"===l.Nuts&&e.push("Nuts"),l.Plants&&"Y"===l.Plants&&e.push("Plants"),l.Poultry&&"Y"===l.Poultry&&e.push("Poultry"),l.Prepared&&"Y"===l.Prepared&&e.push("Prepared Food"),l.Soap&&"Y"===l.Soap&&e.push("Soap"),l.Trees&&"Y"===l.Trees&&e.push("Trees"),l.Wine&&"Y"===l.Wine&&e.push("Wine"),e},getMapUrl=()=>{if(!l)return null;if(l.lat&&l.lon)return"https://maps.google.com/?q=".concat(l.lat,",").concat(l.lon);if(l.Latitude&&l.Longitude)return"https://maps.google.com/?q=".concat(l.Latitude,",").concat(l.Longitude);if(l.location_y&&l.location_x){let e="string"==typeof l.location_y?parseFloat(l.location_y):l.location_y,t="string"==typeof l.location_x?parseFloat(l.location_x):l.location_x;if(!isNaN(e)&&!isNaN(t))return"https://maps.google.com/?q=".concat(e,",").concat(t)}return null};return(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,r.jsxs)("a",{href:"/",className:"inline-flex items-center text-green-600 hover:text-green-800 mb-6",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z",clipRule:"evenodd"})}),"Back to Home"]}),d?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):h?(0,r.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded shadow-sm",children:(0,r.jsx)("p",{className:"text-red-700",children:h})}):l?(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:[(0,r.jsx)("div",{className:"relative h-48 sm:h-64 bg-green-50",children:(0,r.jsx)(n.Z,{src:"/images/market-placeholder.jpg",alt:getMarketName(),fill:!0,className:"object-cover"})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold mb-4 text-gray-800",children:getMarketName()}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-2 text-gray-800 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),"Location"]}),getAddress().length>0?(0,r.jsxs)("div",{className:"text-gray-700",children:[getAddress().map((e,t)=>(0,r.jsx)("p",{children:e},t)),getMapUrl()&&(0,r.jsxs)("a",{href:getMapUrl(),target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-blue-600 hover:text-blue-800",children:["View on Map",(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z"}),(0,r.jsx)("path",{d:"M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z"})]})]})]}):(0,r.jsx)("p",{className:"text-gray-500 italic",children:"Address not available"})]}),(0,r.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-2 text-gray-800 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z",clipRule:"evenodd"})}),"Hours & Schedule"]}),l&&(l.Schedule||l.season1date)?(0,r.jsx)("p",{className:"text-gray-700",children:l&&(l.Schedule||l.season1date)||null}):(0,r.jsx)("p",{className:"text-gray-500 italic",children:"Schedule not available"})]})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold mb-3 text-gray-800 flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-600",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})}),"Available Products"]}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:getProducts().length>0?getProducts().map((e,t)=>(0,r.jsx)("span",{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full",children:e},t)):(0,r.jsx)("p",{className:"text-gray-500 italic",children:"Product information not available"})})]})]})]}):(0,r.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded shadow-sm",children:(0,r.jsx)("p",{className:"text-yellow-700",children:"Market not found. It may have been removed or is temporarily unavailable."})})]})}},2410:function(e,t,a){"use strict";var r=a(7437);a(2265);var o=a(6691),s=a.n(o),l=a(5800),n=a(3267),i=a(8416);t.Z=e=>{let{src:t,alt:a,width:o,height:c,className:d="",fill:u=!1,priority:h=!1,fallback:g="/farm-basket-logo.svg",sizes:m,style:p,...f}=e;console.log("Image component input src:",t);let y=(0,l.K3)(t);console.log("Image component final path:",y);let k=y.match(/\/find-my-farmers-market\//g);return(k&&k.length>1&&(console.error("DUPLICATE PATH DETECTED in Image component: ".concat(k.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",y)),i.BB)?(0,r.jsx)(n.Z,{src:y,alt:a,width:o,height:c,className:d,loading:h?"eager":"lazy",style:{...p,objectFit:u?"cover":void 0,position:u?"absolute":void 0,width:u?"100%":void 0,height:u?"100%":void 0},skipPathProcessing:!0}):(0,r.jsx)(s(),{src:y,alt:a,width:u?void 0:o||100,height:u?void 0:c||100,className:d,fill:u,priority:h,sizes:m,unoptimized:!0,style:p,...f})}},3267:function(e,t,a){"use strict";var r=a(7437);a(2265);var o=a(5800);t.Z=e=>{let{src:t,alt:a,width:s,height:l,className:n="",loading:i="lazy",style:c,skipPathProcessing:d=!1}=e;console.log("StaticImage component input src:",t);let u=d?t:(0,o.K3)(t);console.log("StaticImage component final path:",u);let h=u.match(/\/find-my-farmers-market\//g);return h&&h.length>1&&(console.error("DUPLICATE PATH DETECTED in StaticImage component: ".concat(h.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",u)),(0,r.jsx)("img",{src:u,alt:a,width:s,height:l,className:n,loading:i,style:c})}},9682:function(e,t,a){"use strict";a.r(t),a.d(t,{MarketDataProvider:function(){return MarketDataProvider},useMarketData:function(){return useMarketData}});var r=a(7437),o=a(2265);let s=(0,o.createContext)(void 0);function MarketDataProvider(e){let{children:t}=e,[a,l]=(0,o.useState)([]);return(0,o.useEffect)(()=>{try{let e=localStorage.getItem("savedMarkets");e&&l(JSON.parse(e))}catch(e){console.error("Error loading saved markets:",e)}},[]),(0,o.useEffect)(()=>{if(a.length>0)try{localStorage.setItem("savedMarkets",JSON.stringify(a))}catch(e){console.error("Error saving markets:",e)}},[a]),(0,r.jsx)(s.Provider,{value:{markets:a,setMarkets:l,getMarketById:e=>{let t=a.find(t=>t.id===e||t.listing_id===e);return t||null},clearMarkets:()=>{l([]),localStorage.removeItem("savedMarkets")}},children:t})}function useMarketData(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useMarketData must be used within a MarketDataProvider");return e}},6454:function(e,t,a){"use strict";a.d(t,{pd:function(){return fetchMarkets},xL:function(){return fetchMarketById}});let r="https://www.usdalocalfoodportal.com/api",o="wT29LlT8K9",buildApiUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.endsWith("/")?e:"".concat(e,"/"),s="".concat(r).concat(a,"?apikey=").concat(o),l=Object.entries(t).filter(e=>{let[t,a]=e;return a}).map(e=>{let[t,a]=e;return"".concat(t,"=").concat(encodeURIComponent(a))}).join("&");return l?"".concat(s,"&").concat(l):s};async function fetchMarkets(e){try{console.log("Fetching markets with params:",e);let t=buildApiUrl("/farmersmarket",e),a="".concat(r,"/farmersmarket/?apikey=").concat(o,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20"),s="".concat(r,"/farmersmarket?apikey=").concat(o,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20");console.log("URL Variation 1 (API key hidden):",t.replace(o,"***API_KEY***")),console.log("URL Variation 2 (API key hidden):",a.replace(o,"***API_KEY***")),console.log("URL Variation 3 (API key hidden):",s.replace(o,"***API_KEY***")),console.log("Using URL (API key hidden):",a.replace(o,"***API_KEY***"));let l=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(console.log("Response status:",l.status,l.statusText),console.log("Response headers:",Object.fromEntries([...l.headers.entries()])),!l.ok)throw Error("API responded with status ".concat(l.status));let n=await l.json();return console.log("API Response data type:",typeof n),console.log("API Response is array:",Array.isArray(n)),console.log("API Response structure:",Array.isArray(n)?"Array with ".concat(n.length," items"):Object.keys(n).join(", ")),n}catch(e){throw console.error("Error fetching markets:",e),e}}async function fetchMarketById(e){try{if(!e)throw Error("Market ID is required");let t=buildApiUrl("/farmersmarket/".concat(e));console.log("Fetching market details with URL (API key hidden):",t.replace(o,"***API_KEY***"));let a=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit",cache:"no-store"});if(!a.ok)throw Error("API responded with status ".concat(a.status));let r=await a.json();if(!r)throw Error("No data returned from API");return r}catch(e){throw console.error("Error fetching market details:",e),e}}},5800:function(e,t,a){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t="/find-my-farmers-market",a=e.startsWith("/")?e:"/".concat(e);console.log("Cleaned path:",a);let r=a.startsWith(t),o=a.includes("".concat(t,"/")),s=a===t;if(console.log("Path checks:",{startsWithBase:r,hasBaseInMiddle:o,equalsBase:s,cleanPath:a,basePath:t}),r||o||s)return console.log("Path already contains basePath, returning as-is:",a),a;let l="".concat(t).concat(a);return console.log("getAssetPath js output:",l),l}a.d(t,{K3:function(){return getAssetPath}})},8416:function(e,t,a){"use strict";a.d(t,{BB:function(){return r},sb:function(){return o}});let r=!0,o=r?"/find-my-farmers-market":""},622:function(e,t,a){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=a(2265),o=Symbol.for("react.element"),s=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,n=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,a){var r,s={},c=null,d=null;for(r in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,r)&&!i.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:d,props:s,_owner:n.current}}t.Fragment=s,t.jsx=q,t.jsxs=q},7437:function(e,t,a){"use strict";e.exports=a(622)},4033:function(e,t,a){e.exports=a(94)}},function(e){e.O(0,[691,971,472,744],function(){return e(e.s=456)}),_N_E=e.O()}]);