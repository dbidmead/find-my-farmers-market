(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{9824:function(e,t,s){Promise.resolve().then(s.bind(s,8091))},8091:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ApiTestPage}});var r=s(7437),a=s(2265),n=s(6454);let o=[{zip:"20500",location:"Washington DC"},{zip:"10001",location:"New York City, NY"},{zip:"90210",location:"Beverly Hills, CA"},{zip:"94103",location:"San Francisco, CA"},{zip:"02108",location:"Boston, MA"},{zip:"60601",location:"Chicago, IL"},{zip:"98101",location:"Seattle, WA"},{zip:"19103",location:"Philadelphia, PA"}];var components_ApiTest=()=>{let[e,t]=(0,a.useState)("20500"),[s,i]=(0,a.useState)("20"),[c,l]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),[p,h]=(0,a.useState)(!1),[u,f]=(0,a.useState)(null),[x,y]=(0,a.useState)(!1),handleTest=async()=>{try{if(h(!0),f(null),m(null),x){let t="wT29LlT8K9",r="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(t,"&zip=").concat(e,"&radius=").concat(s);console.log("Trying alternative URL format (API key hidden):",r.replace(t,"***API_KEY***"));let a=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!a.ok)throw Error("API responded with status ".concat(a.status));let n=await a.json();l(n),m({status:a.status,statusText:a.statusText,headers:Object.fromEntries([...a.headers.entries()]),size:"object"==typeof n?JSON.stringify(n).length:"unknown"})}else{let t=await (0,n.pd)({zip:e,radius:s});l(t)}}catch(e){console.error("API test error:",e),f(e instanceof Error?e.message:"Unknown error occurred")}finally{h(!1)}};return(0,r.jsxs)("div",{className:"p-4 border rounded bg-gray-50",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"API Test"}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,r.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm mb-1",children:"ZIP Code:"}),(0,r.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm mb-1",children:"Radius (miles):"}),(0,r.jsx)("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,r.jsx)("div",{className:"self-end flex gap-2",children:(0,r.jsx)("button",{onClick:handleTest,disabled:p,className:"px-4 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:p?"Testing...":"Test API"})})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:x,onChange:()=>y(!x),className:"mr-2"}),(0,r.jsx)("span",{children:"Use alternative URL format"})]}),(0,r.jsxs)("div",{className:"ml-4 text-xs text-gray-500",children:["Current format: ",x?"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS":"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS (standard)"]})]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:"Note: Try checking this box if you're getting empty results. The USDA API may require a specific format."}),(0,r.jsxs)("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Sample ZIP Codes to Try:"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:o.map(s=>(0,r.jsxs)("button",{onClick:()=>t(s.zip),className:"text-xs p-1 rounded ".concat(e===s.zip?"bg-blue-500 text-white":"bg-blue-100 hover:bg-blue-200"),children:[s.zip," - ",s.location]},s.zip))})]})]}),u&&(0,r.jsxs)("div",{className:"p-3 bg-red-100 text-red-700 rounded mb-4",children:["Error: ",u]}),d&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-gray-100 rounded text-sm",children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Response Info:"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Status:"})," ",d.status," ",d.statusText]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Size:"})," ",d.size," bytes"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Content-Type:"})," ",d.headers["content-type"]||"N/A"]})]}),c&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium mb-2",children:"Results:"}),(0,r.jsx)("div",{className:"mb-2 text-sm",children:Array.isArray(c)?"Received array with ".concat(c.length," items"):"Received ".concat(typeof c," with ").concat("object"==typeof c?Object.keys(c).length:0," keys")}),(0,r.jsx)("pre",{className:"bg-gray-100 p-3 text-sm overflow-auto max-h-80 rounded",children:JSON.stringify(c,null,2)})]})]})};function ApiTestPage(){return(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("a",{href:"/",className:"inline-flex items-center text-green-600 hover:text-green-800 mb-6",children:"Back to Home"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API Testing Page"}),(0,r.jsxs)("p",{className:"mb-6",children:["This page tests the API implementation to ensure requests are properly formatted. The URL should match: ",(0,r.jsx)("code",{className:"bg-gray-100 px-1",children:"https://www.usdalocalfoodportal.com/api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS"})]}),(0,r.jsx)(components_ApiTest,{}),(0,r.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 rounded",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Environment Info:"}),(0,r.jsxs)("p",{children:["NODE_ENV: ","production"]}),(0,r.jsxs)("p",{children:["NEXT_PUBLIC_BASE_PATH: ","/find-my-farmers-market"]}),(0,r.jsxs)("p",{children:["API Key Set: ","Yes"]})]})]})}},6454:function(e,t,s){"use strict";s.d(t,{pd:function(){return fetchMarkets},xL:function(){return fetchMarketById}});let r="https://www.usdalocalfoodportal.com/api",a="wT29LlT8K9",buildApiUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.endsWith("/")?e:"".concat(e,"/"),n="".concat(r).concat(s,"?apikey=").concat(a),o=Object.entries(t).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t,s]=e;return"".concat(t,"=").concat(encodeURIComponent(s))}).join("&");return o?"".concat(n,"&").concat(o):n};async function fetchMarkets(e){try{console.log("Fetching markets with params:",e);let t=buildApiUrl("/farmersmarket",e),s="".concat(r,"/farmersmarket/?apikey=").concat(a,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20"),n="".concat(r,"/farmersmarket?apikey=").concat(a,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20");console.log("URL Variation 1 (API key hidden):",t.replace(a,"***API_KEY***")),console.log("URL Variation 2 (API key hidden):",s.replace(a,"***API_KEY***")),console.log("URL Variation 3 (API key hidden):",n.replace(a,"***API_KEY***")),console.log("Using URL (API key hidden):",s.replace(a,"***API_KEY***"));let o=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(console.log("Response status:",o.status,o.statusText),console.log("Response headers:",Object.fromEntries([...o.headers.entries()])),!o.ok)throw Error("API responded with status ".concat(o.status));let i=await o.json();return console.log("API Response data type:",typeof i),console.log("API Response is array:",Array.isArray(i)),console.log("API Response structure:",Array.isArray(i)?"Array with ".concat(i.length," items"):Object.keys(i).join(", ")),i}catch(e){throw console.error("Error fetching markets:",e),e}}async function fetchMarketById(e){try{if(!e)throw Error("Market ID is required");let t=buildApiUrl("/farmersmarket/".concat(e));console.log("Fetching market details with URL (API key hidden):",t.replace(a,"***API_KEY***"));let s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit",cache:"no-store"});if(!s.ok)throw Error("API responded with status ".concat(s.status));let r=await s.json();if(!r)throw Error("No data returned from API");return r}catch(e){throw console.error("Error fetching market details:",e),e}}},622:function(e,t,s){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=s(2265),a=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function q(e,t,s){var r,n={},l=null,d=null;for(r in void 0!==s&&(l=""+s),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)o.call(t,r)&&!c.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:a,type:e,key:l,ref:d,props:n,_owner:i.current}}t.Fragment=n,t.jsx=q,t.jsxs=q},7437:function(e,t,s){"use strict";e.exports=s(622)}},function(e){e.O(0,[971,472,744],function(){return e(e.s=9824)}),_N_E=e.O()}]);