(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{7659:function(e,s,t){Promise.resolve().then(t.bind(t,9256))},9256:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ApiMultiTestPage}});var a=t(7437),r=t(2265),i=t(1396),l=t.n(i);let n=[{zip:"20500",location:"Washington DC"},{zip:"10001",location:"New York City, NY"},{zip:"90210",location:"Beverly Hills, CA"},{zip:"94103",location:"San Francisco, CA"},{zip:"02108",location:"Boston, MA"},{zip:"60601",location:"Chicago, IL"},{zip:"98101",location:"Seattle, WA"},{zip:"19103",location:"Philadelphia, PA"}],o=[{id:"format1",name:"Format 1",url:"https://www.usdalocalfoodportal.com/api/farmersmarket/",description:"With trailing slash after farmersmarket"},{id:"format2",name:"Format 2",url:"https://www.usdalocalfoodportal.com/api/farmersmarket",description:"Without trailing slash after farmersmarket"},{id:"format3",name:"Format 3",url:"https://www.usdalocalfoodportal.com/api/zipSearch",description:"Using zipSearch endpoint"},{id:"format4",name:"Format 4",url:"https://www.ams.usda.gov/local-food-directories/farmersmarkets",description:"Official AMS URL"}];function ApiMultiTestPage(){let[e,s]=(0,r.useState)("20500"),[t,i]=(0,r.useState)("20"),[c,d]=(0,r.useState)({}),[m,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),x="wT29LlT8K9",testAllFormats=async()=>{try{u(!0),h(null);let s={},a=o.map(async a=>{try{let r="".concat(a.url,"?apikey=").concat(x,"&zip=").concat(e,"&radius=").concat(t);console.log("Testing ".concat(a.name," (API key hidden):"),r.replace(x,"***API_KEY***"));let i=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"}),l={id:a.id,status:i.status,statusText:i.statusText,ok:i.ok,headers:Object.fromEntries([...i.headers.entries()])};if(!i.ok){s[a.id]={...l,success:!1,error:"API responded with status ".concat(i.status)};return}let n=await i.json();s[a.id]={...l,success:!0,data:n,dataType:typeof n,isArray:Array.isArray(n),itemCount:Array.isArray(n)?n.length:"object"==typeof n?Object.keys(n).length:0}}catch(e){s[a.id]={id:a.id,success:!1,error:e instanceof Error?e.message:"Unknown error"}}});await Promise.all(a),d(s)}catch(e){console.error("API multi-test error:",e),h(e instanceof Error?e.message:"Unknown error occurred")}finally{u(!1)}};return(0,r.useEffect)(()=>{testAllFormats()},[]),(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(l(),{href:"/",className:"text-green-600 hover:underline",children:"← Back to Home"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API Multi-Format Testing Page"}),(0,a.jsx)("p",{className:"mb-6",children:"This page tests multiple API formats simultaneously to determine which one works with the USDA Farmers Market API."}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm mb-1",children:"ZIP Code:"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>s(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm mb-1",children:"Radius (miles):"}),(0,a.jsx)("input",{type:"text",value:t,onChange:e=>i(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,a.jsx)("div",{className:"self-end",children:(0,a.jsx)("button",{onClick:testAllFormats,disabled:m,className:"px-4 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:m?"Testing...":"Test All Formats"})})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Sample ZIP Codes to Try:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:n.map(t=>(0,a.jsxs)("button",{onClick:()=>s(t.zip),className:"text-xs p-1 rounded ".concat(e===t.zip?"bg-blue-500 text-white":"bg-blue-100 hover:bg-blue-200"),children:[t.zip," - ",t.location]},t.zip))})]})]}),p&&(0,a.jsxs)("div",{className:"p-3 bg-red-100 text-red-700 rounded mb-4",children:["Error: ",p]}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:o.map(s=>{let r=c[s.id];return(0,a.jsxs)("div",{className:"border rounded p-4 ".concat((null==r?void 0:r.success)?"bg-green-50 border-green-200":r?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"),children:[(0,a.jsx)("h3",{className:"font-bold text-lg mb-2",children:s.name}),(0,a.jsx)("p",{className:"text-sm mb-2",children:s.description}),(0,a.jsxs)("div",{className:"text-xs mb-2 break-all",children:[(0,a.jsx)("span",{className:"font-medium",children:"URL:"})," ",s.url,"?apikey=***&zip=",e,"&radius=",t]}),!r&&(0,a.jsx)("div",{className:"text-gray-500 text-sm",children:"Testing..."}),(null==r?void 0:r.error)&&(0,a.jsxs)("div",{className:"text-red-600 text-sm mt-2",children:["Error: ",r.error]}),(null==r?void 0:r.success)&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsxs)("div",{className:"text-sm mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"})," ",r.status," ",r.statusText]}),(0,a.jsxs)("div",{className:"text-sm mb-2",children:[(0,a.jsx)("span",{className:"font-medium",children:"Data type:"})," ",r.dataType,r.isArray&&" (Array with ".concat(r.itemCount," items)"),!r.isArray&&"object"===r.dataType&&" (Object with ".concat(r.itemCount," keys)")]}),r.data&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium mb-1",children:"Sample Data:"}),(0,a.jsx)("pre",{className:"bg-white p-2 text-xs overflow-auto max-h-40 rounded border",children:JSON.stringify(r.data,null,2)})]})]})]},s.id)})}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 rounded",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Environment Info:"}),(0,a.jsxs)("p",{children:["NODE_ENV: ","production"]}),(0,a.jsxs)("p",{children:["NEXT_PUBLIC_BASE_PATH: ","/find-my-farmers-market"]}),(0,a.jsxs)("p",{children:["API Key Set: ","Yes"]})]})]})}}},function(e){e.O(0,[176,971,472,744],function(){return e(e.s=7659)}),_N_E=e.O()}]);