(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{9824:function(e,t,s){Promise.resolve().then(s.bind(s,8091))},8091:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ApiTestPage}});var a=s(7437),r=s(2265),n=s(6454);let i=[{zip:"20500",location:"Washington DC"},{zip:"10001",location:"New York City, NY"},{zip:"90210",location:"Beverly Hills, CA"},{zip:"94103",location:"San Francisco, CA"},{zip:"02108",location:"Boston, MA"},{zip:"60601",location:"Chicago, IL"},{zip:"98101",location:"Seattle, WA"},{zip:"19103",location:"Philadelphia, PA"}];var components_ApiTest=()=>{let[e,t]=(0,r.useState)("20500"),[s,o]=(0,r.useState)("20"),[c,l]=(0,r.useState)(null),[d,m]=(0,r.useState)(null),[p,h]=(0,r.useState)(!1),[u,x]=(0,r.useState)(null),[f,g]=(0,r.useState)(!1),handleTest=async()=>{try{if(h(!0),x(null),m(null),f){let t="wT29LlT8K9",a="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(t,"&zip=").concat(e,"&radius=").concat(s);console.log("Trying alternative URL format (API key hidden):",a.replace(t,"***API_KEY***"));let r=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!r.ok)throw Error("API responded with status ".concat(r.status));let n=await r.json();l(n),m({status:r.status,statusText:r.statusText,headers:Object.fromEntries([...r.headers.entries()]),size:"object"==typeof n?JSON.stringify(n).length:"unknown"})}else{let t=await (0,n.pd)({zip:e,radius:s});l(t)}}catch(e){console.error("API test error:",e),x(e instanceof Error?e.message:"Unknown error occurred")}finally{h(!1)}};return(0,a.jsxs)("div",{className:"p-4 border rounded bg-gray-50",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"API Test"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm mb-1",children:"ZIP Code:"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm mb-1",children:"Radius (miles):"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>o(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,a.jsx)("div",{className:"self-end flex gap-2",children:(0,a.jsx)("button",{onClick:handleTest,disabled:p,className:"px-4 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:p?"Testing...":"Test API"})})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:f,onChange:()=>g(!f),className:"mr-2"}),(0,a.jsx)("span",{children:"Use alternative URL format"})]}),(0,a.jsxs)("div",{className:"ml-4 text-xs text-gray-500",children:["Current format: ",f?"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS":"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS (standard)"]})]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Note: Try checking this box if you're getting empty results. The USDA API may require a specific format."}),(0,a.jsxs)("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Sample ZIP Codes to Try:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:i.map(s=>(0,a.jsxs)("button",{onClick:()=>t(s.zip),className:"text-xs p-1 rounded ".concat(e===s.zip?"bg-blue-500 text-white":"bg-blue-100 hover:bg-blue-200"),children:[s.zip," - ",s.location]},s.zip))})]})]}),u&&(0,a.jsxs)("div",{className:"p-3 bg-red-100 text-red-700 rounded mb-4",children:["Error: ",u]}),d&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-100 rounded text-sm",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Response Info:"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Status:"})," ",d.status," ",d.statusText]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Size:"})," ",d.size," bytes"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Content-Type:"})," ",d.headers["content-type"]||"N/A"]})]}),c&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Results:"}),(0,a.jsx)("div",{className:"mb-2 text-sm",children:Array.isArray(c)?"Received array with ".concat(c.length," items"):"Received ".concat(typeof c," with ").concat("object"==typeof c?Object.keys(c).length:0," keys")}),(0,a.jsx)("pre",{className:"bg-gray-100 p-3 text-sm overflow-auto max-h-80 rounded",children:JSON.stringify(c,null,2)})]})]})},o=s(5800),c=s(1396),l=s.n(c);function ApiTestPage(){return(0,a.jsxs)("div",{className:"p-8",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(l(),{href:(0,o.K3)("/"),className:"text-green-600 hover:underline",children:"← Back to Home"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API Testing Page"}),(0,a.jsxs)("p",{className:"mb-6",children:["This page tests the API implementation to ensure requests are properly formatted. The URL should match: ",(0,a.jsx)("code",{className:"bg-gray-100 px-1",children:"https://www.usdalocalfoodportal.com/api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS"})]}),(0,a.jsx)(components_ApiTest,{}),(0,a.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 rounded",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Environment Info:"}),(0,a.jsxs)("p",{children:["NODE_ENV: ","production"]}),(0,a.jsxs)("p",{children:["NEXT_PUBLIC_BASE_PATH: ","/find-my-farmers-market"]}),(0,a.jsxs)("p",{children:["API Key Set: ","Yes"]})]})]})}},6454:function(e,t,s){"use strict";s.d(t,{pd:function(){return fetchMarkets}});let a="https://www.usdalocalfoodportal.com/api",r="wT29LlT8K9",buildApiUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.endsWith("/")?e:"".concat(e,"/"),n="".concat(a).concat(s,"?apikey=").concat(r),i=Object.entries(t).filter(e=>{let[t,s]=e;return s}).map(e=>{let[t,s]=e;return"".concat(t,"=").concat(encodeURIComponent(s))}).join("&");return i?"".concat(n,"&").concat(i):n};async function fetchMarkets(e){try{console.log("Fetching markets with params:",e);let t=buildApiUrl("/farmersmarket",e),s="".concat(a,"/farmersmarket/?apikey=").concat(r,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20"),n="".concat(a,"/farmersmarket?apikey=").concat(r,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20");console.log("URL Variation 1 (API key hidden):",t.replace(r,"***API_KEY***")),console.log("URL Variation 2 (API key hidden):",s.replace(r,"***API_KEY***")),console.log("URL Variation 3 (API key hidden):",n.replace(r,"***API_KEY***")),console.log("Using URL (API key hidden):",s.replace(r,"***API_KEY***"));let i=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(console.log("Response status:",i.status,i.statusText),console.log("Response headers:",Object.fromEntries([...i.headers.entries()])),!i.ok)throw Error("API responded with status ".concat(i.status));let o=await i.json();return console.log("API Response data type:",typeof o),console.log("API Response is array:",Array.isArray(o)),console.log("API Response structure:",Array.isArray(o)?"Array with ".concat(o.length," items"):Object.keys(o).join(", ")),o}catch(e){throw console.error("Error fetching markets:",e),e}}},5800:function(e,t,s){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t=e.match(/\/find-my-farmers-market\//g);t&&t.length>0&&(console.error("Input path already contains ".concat(t.length," repetitions of /find-my-farmers-market/")),console.error("Input path:",e));let s="/find-my-farmers-market";if(!s||e.includes(s)||e.includes(s.slice(1)))return e.startsWith("/")?e:"/".concat(e);let a=e.startsWith("/")?e.slice(1):e,r="".concat(s,"/").concat(a);return console.log("getAssetPath js output:",r),r}s.d(t,{K3:function(){return getAssetPath}})}},function(e){e.O(0,[176,971,472,744],function(){return e(e.s=9824)}),_N_E=e.O()}]);