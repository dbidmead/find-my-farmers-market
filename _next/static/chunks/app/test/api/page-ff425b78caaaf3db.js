(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[786],{9824:function(e,t,a){Promise.resolve().then(a.bind(a,8091))},8091:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ApiTestPage}});var s=a(7437),r=a(2265),c=a(6454),components_ApiTest=()=>{let[e,t]=(0,r.useState)("20500"),[a,o]=(0,r.useState)("20"),[n,l]=(0,r.useState)(null),[i,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[f,x]=(0,r.useState)(!1),handleTest=async()=>{try{if(m(!0),h(null),d([]),f){let t="wT29LlT8K9",s="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(t,"&zip=").concat(e,"&radius=").concat(a);console.log("Trying alternative URL format (API key hidden):",s.replace(t,"***API_KEY***"));let r=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!r.ok)throw Error("API responded with status ".concat(r.status));let c=await r.json();l(c)}else{let t=await (0,c.pd)({zip:e,radius:a});l(t)}}catch(e){console.error("API test error:",e),h(e instanceof Error?e.message:"Unknown error occurred")}finally{m(!1)}},handleTestAllFormats=async()=>{try{m(!0),h(null),l(null);let t=await (0,c.zc)(e,a);d(t);let s=t.find(e=>e.success&&e.data);s&&l(s.data)}catch(e){console.error("API format test error:",e),h(e instanceof Error?e.message:"Unknown error occurred")}finally{m(!1)}};return(0,s.jsxs)("div",{className:"p-4 border rounded bg-gray-50",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"API Test"}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 mb-4",children:[(0,s.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"ZIP Code:"}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>t(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm mb-1",children:"Radius (miles):"}),(0,s.jsx)("input",{type:"text",value:a,onChange:e=>o(e.target.value),className:"px-2 py-1 border rounded"})]}),(0,s.jsxs)("div",{className:"self-end flex gap-2",children:[(0,s.jsx)("button",{onClick:handleTest,disabled:u,className:"px-4 py-1 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:u?"Testing...":"Test API"}),(0,s.jsx)("button",{onClick:handleTestAllFormats,disabled:u,className:"px-4 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:u?"Testing...":"Test All Formats"})]})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("label",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",checked:f,onChange:()=>x(!f),className:"mr-2"}),(0,s.jsx)("span",{children:"Use alternative URL format"})]}),(0,s.jsxs)("div",{className:"ml-4 text-xs text-gray-500",children:["Current format: ",f?"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS":"api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS (standard)"]})]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Note: Try checking this box if you're getting empty results. The USDA API may require a specific format."})]}),p&&(0,s.jsxs)("div",{className:"p-3 bg-red-100 text-red-700 rounded mb-4",children:["Error: ",p]}),i.length>0&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium mb-2",children:"Format Test Results:"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2",children:i.map((e,t)=>(0,s.jsxs)("div",{className:"p-2 rounded ".concat(e.success?"bg-green-100 border border-green-300":"bg-red-100 border border-red-300"),children:[(0,s.jsxs)("div",{className:"font-medium",children:[e.format,": ",e.success?"✅ Successful":"❌ Failed"]}),(0,s.jsxs)("div",{className:"text-xs mt-1 break-all",children:["URL: ",e.url]}),e.status&&(0,s.jsxs)("div",{className:"text-xs",children:["Status: ",e.status]}),e.error&&(0,s.jsxs)("div",{className:"text-xs text-red-600",children:["Error: ",e.error]}),e.success&&(0,s.jsxs)("div",{className:"text-xs mt-1",children:["Data: ",Array.isArray(e.data)?"Array with ".concat(e.data.length," items"):"object"==typeof e.data&&null!==e.data?"Object with keys: ".concat(Object.keys(e.data).join(", ")):String(e.data)]})]},t))})]}),n&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium mb-2",children:"Results:"}),(0,s.jsx)("pre",{className:"bg-gray-100 p-3 text-sm overflow-auto max-h-80 rounded",children:JSON.stringify(n,null,2)})]})]})},o=a(5800),n=a(1396),l=a.n(n);function ApiTestPage(){return(0,s.jsxs)("div",{className:"p-8",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)(l(),{href:(0,o.K3)("/"),className:"text-green-600 hover:underline",children:"← Back to Home"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"API Testing Page"}),(0,s.jsxs)("p",{className:"mb-6",children:["This page tests the API implementation to ensure requests are properly formatted. The URL should match: ",(0,s.jsx)("code",{className:"bg-gray-100 px-1",children:"https://www.usdalocalfoodportal.com/api/farmersmarket/?apikey=***&zip=ZIP&radius=RADIUS"})]}),(0,s.jsx)(components_ApiTest,{}),(0,s.jsxs)("div",{className:"mt-8 p-4 bg-gray-100 rounded",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Environment Info:"}),(0,s.jsxs)("p",{children:["NODE_ENV: ","production"]}),(0,s.jsxs)("p",{children:["NEXT_PUBLIC_BASE_PATH: ","/find-my-farmers-market"]}),(0,s.jsxs)("p",{children:["API Key Set: ","Yes"]})]})]})}},6454:function(e,t,a){"use strict";a.d(t,{pd:function(){return fetchMarkets},zc:function(){return testApiFormats}});let s="https://www.usdalocalfoodportal.com/api",r="wT29LlT8K9",buildApiUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.endsWith("/")?e:"".concat(e,"/"),c="".concat(s).concat(a,"?apikey=").concat(r),o=Object.entries(t).filter(e=>{let[t,a]=e;return a}).map(e=>{let[t,a]=e;return"".concat(t,"=").concat(encodeURIComponent(a))}).join("&");return o?"".concat(c,"&").concat(o):c};async function fetchMarkets(e){try{let t=buildApiUrl("/farmersmarket",e);console.log("Fetching markets with URL (API key hidden):",t.replace(r,"***API_KEY***"));let a="".concat(s,"/farmersmarket/?apikey=").concat(r,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20");console.log("Alternative URL format (API key hidden):",a.replace(r,"***API_KEY***"));let c=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!c.ok)throw Error("API responded with status ".concat(c.status));let o=await c.json();console.log("API Response data type:",typeof o),console.log("API Response structure:",Array.isArray(o)?"Array with ".concat(o.length," items"):Object.keys(o).join(", "));let n=[];return o&&Array.isArray(o)?n=o:o&&o.results&&Array.isArray(o.results)?n=o.results:o&&"object"==typeof o&&(n=[o]),console.log("Extracted ".concat(n.length," markets from response")),o}catch(e){throw console.error("Error fetching markets:",e),e}}async function testApiFormats(e,t){let a="wT29LlT8K9",r=[],c=[];try{let o="".concat(s,"/farmersmarket/?apikey=").concat(a,"&zip=").concat(e,"&radius=").concat(t);console.log("Testing Format 1 (API key hidden):",o.replace(a,"***API_KEY***"));let n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){let e=await n.json();r.push({format:"Format 1",success:!0,url:o.replace(a,"***API_KEY***"),data:e})}else r.push({format:"Format 1",success:!1,status:n.status,url:o.replace(a,"***API_KEY***")}),c.push("Format 1 failed with status ".concat(n.status))}catch(a){r.push({format:"Format 1",success:!1,error:String(a),url:"".concat(s,"/farmersmarket/?apikey=***API_KEY***&zip=").concat(e,"&radius=").concat(t)}),c.push("Format 1 exception: ".concat(a))}try{let o="".concat(s,"/farmersmarket?apikey=").concat(a,"&zip=").concat(e,"&radius=").concat(t);console.log("Testing Format 2 (API key hidden):",o.replace(a,"***API_KEY***"));let n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){let e=await n.json();r.push({format:"Format 2",success:!0,url:o.replace(a,"***API_KEY***"),data:e})}else r.push({format:"Format 2",success:!1,status:n.status,url:o.replace(a,"***API_KEY***")}),c.push("Format 2 failed with status ".concat(n.status))}catch(a){r.push({format:"Format 2",success:!1,error:String(a),url:"".concat(s,"/farmersmarket?apikey=***API_KEY***&zip=").concat(e,"&radius=").concat(t)}),c.push("Format 2 exception: ".concat(a))}try{let o="".concat(s,"/farmersmarket/zipSearch?apikey=").concat(a,"&zip=").concat(e,"&radius=").concat(t);console.log("Testing Format 3 (API key hidden):",o.replace(a,"***API_KEY***"));let n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){let e=await n.json();r.push({format:"Format 3",success:!0,url:o.replace(a,"***API_KEY***"),data:e})}else r.push({format:"Format 3",success:!1,status:n.status,url:o.replace(a,"***API_KEY***")}),c.push("Format 3 failed with status ".concat(n.status))}catch(a){r.push({format:"Format 3",success:!1,error:String(a),url:"".concat(s,"/farmersmarket/zipSearch?apikey=***API_KEY***&zip=").concat(e,"&radius=").concat(t)}),c.push("Format 3 exception: ".concat(a))}try{let o="".concat(s,"/zipSearch?apikey=").concat(a,"&zip=").concat(e,"&radius=").concat(t);console.log("Testing Format 4 (API key hidden):",o.replace(a,"***API_KEY***"));let n=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json"}});if(n.ok){let e=await n.json();r.push({format:"Format 4",success:!0,url:o.replace(a,"***API_KEY***"),data:e})}else r.push({format:"Format 4",success:!1,status:n.status,url:o.replace(a,"***API_KEY***")}),c.push("Format 4 failed with status ".concat(n.status))}catch(a){r.push({format:"Format 4",success:!1,error:String(a),url:"".concat(s,"/zipSearch?apikey=***API_KEY***&zip=").concat(e,"&radius=").concat(t)}),c.push("Format 4 exception: ".concat(a))}return console.log("API Format Test Results:",r),c.length>0&&console.error("API Format Test Errors:",c),r}},5800:function(e,t,a){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t=e.match(/\/find-my-farmers-market\//g);t&&t.length>0&&(console.error("Input path already contains ".concat(t.length," repetitions of /find-my-farmers-market/")),console.error("Input path:",e));let a="/find-my-farmers-market";if(!a||e.includes(a)||e.includes(a.slice(1)))return e.startsWith("/")?e:"/".concat(e);let s=e.startsWith("/")?e.slice(1):e,r="".concat(a,"/").concat(s);return console.log("getAssetPath js output:",r),r}a.d(t,{K3:function(){return getAssetPath}})}},function(e){e.O(0,[176,971,472,744],function(){return e(e.s=9824)}),_N_E=e.O()}]);