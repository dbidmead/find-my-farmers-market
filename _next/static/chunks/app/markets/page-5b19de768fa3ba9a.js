(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{2523:function(e,t,s){Promise.resolve().then(s.bind(s,7431))},7431:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return MarketsPage}});var r=s(7437),a=s(2265),l=s(4033),n=s(1396),o=s.n(n),i=s(5800),c=s(2410),components_MarketCard=e=>{let{market:t}=e,s=t.listing_name||t.marketname||t.MarketName||"Farmers Market";t.listing_desc||t.brief_desc;let a=t.location_address||[t.street||t.Address,t.city||t.City,t.state||t.State].filter(Boolean).join(", "),l=t.listing_image||"/images/market-placeholder.jpg",n="number"==typeof t.distance?"".concat(t.distance.toFixed(1)," mi"):"",d=t.location_x&&t.location_y,m=d?"https://maps.google.com/?q=".concat(t.location_y,",").concat(t.location_x):"";return(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"relative h-48",children:[l.startsWith("http")?(0,r.jsx)("img",{src:l,alt:s,className:"w-full h-full object-cover"}):(0,r.jsx)(c.Z,{src:"/images/market-placeholder.jpg",alt:s,fill:!0,className:"object-cover"}),n&&(0,r.jsx)("div",{className:"absolute top-3 right-3 bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:n})]}),(0,r.jsxs)("div",{className:"p-4 flex-grow flex flex-col",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-1 text-gray-800 line-clamp-1",children:s}),a&&(0,r.jsxs)("div",{className:"flex items-start mb-2",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 mr-1 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,r.jsx)("p",{className:"text-gray-500 text-sm line-clamp-1",children:a})]}),(0,r.jsxs)("div",{className:"mt-auto pt-3 flex items-center justify-between border-t border-gray-100",children:[(0,r.jsxs)(o(),{href:(0,i.K3)("/markets/".concat(t.id)),className:"text-green-600 hover:text-green-800 font-medium text-sm inline-flex items-center",children:["View Details",(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),m&&(0,r.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 text-sm",children:"Maps"})]})]})]})};function MarketsPage(){let e=(0,l.useSearchParams)(),[t,s]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[c,d]=(0,a.useState)(null),m=(null==e?void 0:e.get("zip"))||"",h=(null==e?void 0:e.get("radius"))?parseInt((null==e?void 0:e.get("radius"))||"20"):20;return(0,a.useEffect)(()=>{(async function(){if(!m){d("ZIP code is required"),i(!1);return}try{i(!0);let e="wT29LlT8K9",t="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(e,"&zip=").concat(m,"&radius=").concat(h);console.log("Making direct API call to USDA API (API key hidden):",t.replace(e,"***API_KEY***"));let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!r.ok)throw Error("API responded with status ".concat(r.status));let a=await r.json();Array.isArray(a)?s(a):a&&a.results&&Array.isArray(a.results)?s(a.results):a&&a.data&&Array.isArray(a.data)?s(a.data):(console.error("Unexpected API response format:",a),s([])),d(null)}catch(e){console.error("Error fetching markets:",e),d("Failed to fetch farmers markets. Please try again."),s([])}finally{i(!1)}})()},[m,h]),(0,r.jsxs)("div",{className:"markets-page container mx-auto px-4 py-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold mb-6",children:["Farmers Markets Near ",m]}),n?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mb-4"}),(0,r.jsx)("p",{children:"Loading markets..."})]}):c?(0,r.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:[(0,r.jsx)("p",{children:c}),(0,r.jsx)(o(),{href:"/",children:(0,r.jsx)("button",{className:"mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsxs)("p",{className:"mb-4",children:["No markets found near ZIP code ",m,"."]}),(0,r.jsx)(o(),{href:"/",children:(0,r.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"mb-6",children:["Found ",t.length," markets within ",h," miles of ",m]}),(0,r.jsx)(o(),{href:"/",children:(0,r.jsx)("button",{className:"mb-6 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"New Search"})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e,t)=>(0,r.jsx)(components_MarketCard,{market:e},t))})]})]})}},2410:function(e,t,s){"use strict";var r=s(7437);s(2265);var a=s(6691),l=s.n(a),n=s(5800),o=s(3267),i=s(8416);t.Z=e=>{let{src:t,alt:s,width:a,height:c,className:d="",fill:m=!1,priority:h=!1,fallback:u="/farm-basket-logo.svg",sizes:g,style:f,...x}=e;console.log("Image component input src:",t);let p=(0,n.K3)(t);console.log("Image component final path:",p);let b=p.match(/\/find-my-farmers-market\//g);return(b&&b.length>1&&(console.error("DUPLICATE PATH DETECTED in Image component: ".concat(b.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",p)),i.BB)?(0,r.jsx)(o.Z,{src:p,alt:s,width:a,height:c,className:d,loading:h?"eager":"lazy",style:{...f,objectFit:m?"cover":void 0,position:m?"absolute":void 0,width:m?"100%":void 0,height:m?"100%":void 0},skipPathProcessing:!0}):(0,r.jsx)(l(),{src:p,alt:s,width:m?void 0:a||100,height:m?void 0:c||100,className:d,fill:m,priority:h,sizes:g,unoptimized:!0,style:f,...x})}},3267:function(e,t,s){"use strict";var r=s(7437);s(2265);var a=s(5800);t.Z=e=>{let{src:t,alt:s,width:l,height:n,className:o="",loading:i="lazy",style:c,skipPathProcessing:d=!1}=e;console.log("StaticImage component input src:",t);let m=d?t:(0,a.K3)(t);console.log("StaticImage component final path:",m);let h=m.match(/\/find-my-farmers-market\//g);return h&&h.length>1&&(console.error("DUPLICATE PATH DETECTED in StaticImage component: ".concat(h.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",m)),(0,r.jsx)("img",{src:m,alt:s,width:l,height:n,className:o,loading:i,style:c})}},5800:function(e,t,s){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t="/find-my-farmers-market",s=e.startsWith("/")?e:"/".concat(e);console.log("Cleaned path:",s);let r=s.startsWith(t),a=s.includes("".concat(t,"/")),l=s===t;if(console.log("Path checks:",{startsWithBase:r,hasBaseInMiddle:a,equalsBase:l,cleanPath:s,basePath:t}),r||a||l)return console.log("Path already contains basePath, returning as-is:",s),s;let n="".concat(t).concat(s);return console.log("getAssetPath js output:",n),n}s.d(t,{K3:function(){return getAssetPath}})},8416:function(e,t,s){"use strict";s.d(t,{BB:function(){return r},sb:function(){return a}});let r=!0,a=r?"/find-my-farmers-market":""},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[176,691,971,472,744],function(){return e(e.s=2523)}),_N_E=e.O()}]);