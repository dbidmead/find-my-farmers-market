(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{2523:function(e,t,s){Promise.resolve().then(s.bind(s,7431))},7431:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return MarketsPage}});var r=s(7437),a=s(2265),n=s(4033),l=s(1396),o=s.n(l),i=s(5800),c=s(2410),components_MarketCard=e=>{let{market:t}=e,s=t.listing_name||t.marketname||t.MarketName||"Farmers Market",a=t.listing_desc||t.brief_desc||"",n=t.location_address||[t.street||t.Address,t.city||t.City,t.state||t.State].filter(Boolean).join(", "),l=t.listing_image||"/images/market-placeholder.jpg",d="number"==typeof t.distance?"".concat(t.distance.toFixed(1)," miles away"):"",m=t.updateTime?new Date(t.updateTime).toLocaleDateString():"",h=[t.contact_name,t.contact_email,t.contact_phone].filter(Boolean),u=t.location_x&&t.location_y,g=u?"https://maps.google.com/?q=".concat(t.location_y,",").concat(t.location_x):"";return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden h-full flex flex-col",children:[(0,r.jsxs)("div",{className:"relative h-48 overflow-hidden",children:[l.startsWith("http")?(0,r.jsx)("img",{src:l,alt:s,className:"w-full h-full object-cover"}):(0,r.jsx)(c.Z,{src:"/images/market-placeholder.jpg",alt:s,fill:!0,className:"object-cover"}),d&&(0,r.jsx)("div",{className:"absolute top-3 right-3 bg-green-600 text-white px-2 py-1 rounded text-sm font-medium",children:d})]}),(0,r.jsxs)("div",{className:"p-4 flex-grow flex flex-col",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-2 text-gray-800",children:s}),a&&(0,r.jsx)("p",{className:"text-gray-600 mb-3 text-sm line-clamp-2",children:a}),n&&(0,r.jsxs)("div",{className:"mb-3 flex items-start",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:n})]}),h.length>0&&(0,r.jsxs)("div",{className:"mb-3 flex items-start",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,r.jsx)("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),(0,r.jsx)("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),(0,r.jsx)("div",{className:"text-sm text-gray-600",children:h.map((e,t)=>(0,r.jsx)("p",{children:e},t))})]}),(0,r.jsxs)("div",{className:"mt-auto pt-3 flex items-center justify-between",children:[(0,r.jsx)(o(),{href:(0,i.K3)("/markets/".concat(t.id)),className:"text-green-600 hover:text-green-800 font-medium text-sm",children:"View Details â†’"}),g&&(0,r.jsx)("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 text-sm",children:"Open in Maps"})]}),m&&(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:["Updated: ",m]})]})]})};function MarketsPage(){let e=(0,n.useSearchParams)(),[t,s]=(0,a.useState)([]),[l,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(null),h=(null==e?void 0:e.get("zip"))||"",u=(null==e?void 0:e.get("radius"))?parseInt((null==e?void 0:e.get("radius"))||"20"):20;return(0,a.useEffect)(()=>{(async function(){if(!h){m("ZIP code is required"),c(!1);return}try{c(!0);let e="wT29LlT8K9",t="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(e,"&zip=").concat(h,"&radius=").concat(u);console.log("Making direct API call to USDA API (API key hidden):",t.replace(e,"***API_KEY***"));let r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!r.ok)throw Error("API responded with status ".concat(r.status));let a=await r.json();Array.isArray(a)?s(a):a&&a.results&&Array.isArray(a.results)?s(a.results):(console.error("Unexpected API response format:",a),s([])),m(null)}catch(e){console.error("Error fetching markets:",e),m("Failed to fetch farmers markets. Please try again."),s([])}finally{c(!1)}})()},[h,u]),(0,r.jsxs)("div",{className:"markets-page container mx-auto px-4 py-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold mb-6",children:["Farmers Markets Near ",h]}),l?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mb-4"}),(0,r.jsx)("p",{children:"Loading markets..."})]}):d?(0,r.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:[(0,r.jsx)("p",{children:d}),(0,r.jsx)(o(),{href:(0,i.K3)("/"),children:(0,r.jsx)("button",{className:"mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):0===t.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsxs)("p",{className:"mb-4",children:["No markets found near ZIP code ",h,"."]}),(0,r.jsx)(o(),{href:(0,i.K3)("/"),children:(0,r.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{className:"mb-6",children:["Found ",t.length," markets within ",u," miles of ",h]}),(0,r.jsx)(o(),{href:(0,i.K3)("/"),children:(0,r.jsx)("button",{className:"mb-6 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"New Search"})}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e,t)=>(0,r.jsx)(components_MarketCard,{market:e},t))})]})]})}},2410:function(e,t,s){"use strict";var r=s(7437);s(2265);var a=s(6691),n=s.n(a),l=s(5800),o=s(3267),i=s(8416);t.Z=e=>{let{src:t,alt:s,width:a,height:c,className:d="",fill:m=!1,priority:h=!1,fallback:u="/farm-basket-logo.svg",sizes:g,style:x,...p}=e;console.log("Image component input src:",t);let f=(0,l.K3)(t);console.log("Image component final path:",f);let j=f.match(/\/find-my-farmers-market\//g);return(j&&j.length>1&&(console.error("DUPLICATE PATH DETECTED in Image component: ".concat(j.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",f)),i.BB)?(0,r.jsx)(o.Z,{src:f,alt:s,width:a,height:c,className:d,loading:h?"eager":"lazy",style:{...x,objectFit:m?"cover":void 0,position:m?"absolute":void 0,width:m?"100%":void 0,height:m?"100%":void 0},skipPathProcessing:!0}):(0,r.jsx)(n(),{src:f,alt:s,width:m?void 0:a||100,height:m?void 0:c||100,className:d,fill:m,priority:h,sizes:g,unoptimized:!0,style:x,...p})}},3267:function(e,t,s){"use strict";var r=s(7437);s(2265);var a=s(5800);t.Z=e=>{let{src:t,alt:s,width:n,height:l,className:o="",loading:i="lazy",style:c,skipPathProcessing:d=!1}=e;console.log("StaticImage component input src:",t);let m=d?t:(0,a.K3)(t);console.log("StaticImage component final path:",m);let h=m.match(/\/find-my-farmers-market\//g);return h&&h.length>1&&(console.error("DUPLICATE PATH DETECTED in StaticImage component: ".concat(h.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",m)),(0,r.jsx)("img",{src:m,alt:s,width:n,height:l,className:o,loading:i,style:c})}},5800:function(e,t,s){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t=e.match(/\/find-my-farmers-market\//g);t&&t.length>0&&(console.error("Input path already contains ".concat(t.length," repetitions of /find-my-farmers-market/")),console.error("Input path:",e));let s="/find-my-farmers-market";if(!s||e.includes(s)||e.includes(s.slice(1)))return e.startsWith("/")?e:"/".concat(e);let r=e.startsWith("/")?e.slice(1):e,a="".concat(s,"/").concat(r);return console.log("getAssetPath js output:",a),a}s.d(t,{K3:function(){return getAssetPath}})},8416:function(e,t,s){"use strict";s.d(t,{BB:function(){return r},sb:function(){return a}});let r=!0,a=r?"/find-my-farmers-market":""},4033:function(e,t,s){e.exports=s(94)}},function(e){e.O(0,[176,691,971,472,744],function(){return e(e.s=2523)}),_N_E=e.O()}]);