(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{2523:function(e,t,r){Promise.resolve().then(r.bind(r,6564))},6564:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return MarketsPage}});var s=r(7437),a=r(2265),n=r(4033),o=r(1396),l=r.n(o);async function searchMarkets(e){try{return console.log("Static export mode - skipping API call for market search"),[]}catch(e){return console.error("Error searching markets:",e),[]}}r(6454);var i=r(5800),c=r(2410),components_MarketCard=e=>{let{market:t}=e,r=t.listing_name||t.marketname||t.MarketName||"Farmers Market",a=t.listing_desc||t.brief_desc||"",n=t.location_address||[t.street||t.Address,t.city||t.City,t.state||t.State].filter(Boolean).join(", "),o=t.listing_image||"/images/market-placeholder.jpg",d="number"==typeof t.distance?"".concat(t.distance.toFixed(1)," miles away"):"",m=t.updateTime?new Date(t.updateTime).toLocaleDateString():"",h=[t.contact_name,t.contact_email,t.contact_phone].filter(Boolean),u=t.location_x&&t.location_y,g=u?"https://maps.google.com/?q=".concat(t.location_y,",").concat(t.location_x):"";return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-48 overflow-hidden",children:[o.startsWith("http")?(0,s.jsx)("img",{src:o,alt:r,className:"w-full h-full object-cover"}):(0,s.jsx)(c.Z,{src:"/images/market-placeholder.jpg",alt:r,fill:!0,className:"object-cover"}),d&&(0,s.jsx)("div",{className:"absolute top-3 right-3 bg-green-600 text-white px-2 py-1 rounded text-sm font-medium",children:d})]}),(0,s.jsxs)("div",{className:"p-4 flex-grow flex flex-col",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2 text-gray-800",children:r}),a&&(0,s.jsx)("p",{className:"text-gray-600 mb-3 text-sm line-clamp-2",children:a}),n&&(0,s.jsxs)("div",{className:"mb-3 flex items-start",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,s.jsx)("p",{className:"text-gray-600 text-sm",children:n})]}),h.length>0&&(0,s.jsxs)("div",{className:"mb-3 flex items-start",children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-500 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,s.jsx)("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),(0,s.jsx)("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:h.map((e,t)=>(0,s.jsx)("p",{children:e},t))})]}),(0,s.jsxs)("div",{className:"mt-auto pt-3 flex items-center justify-between",children:[(0,s.jsx)(l(),{href:(0,i.K3)("/markets/".concat(t.id)),className:"text-green-600 hover:text-green-800 font-medium text-sm",children:"View Details â†’"}),g&&(0,s.jsx)("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 text-sm",children:"Open in Maps"})]}),m&&(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-400",children:["Updated: ",m]})]})]})};function MarketsPage(){let e=(0,n.useSearchParams)(),[t,r]=(0,a.useState)([]),[o,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(null),h=(null==e?void 0:e.get("zip"))||"",u=(null==e?void 0:e.get("radius"))?parseInt((null==e?void 0:e.get("radius"))||"20"):20;return(0,a.useEffect)(()=>{(async function(){if(!h){m("ZIP code is required"),c(!1);return}try{c(!0);let e=await searchMarkets({zip:h,radius:u});console.log("Markets results:",e),r(e),m(null)}catch(e){console.error("Error fetching markets:",e),m("Failed to fetch farmers markets. Please try again.")}finally{c(!1)}})()},[h,u]),(0,s.jsx)("main",{className:"flex min-h-screen flex-col items-center p-8",children:(0,s.jsxs)("div",{className:"w-full max-w-6xl",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-800",children:"Farmers Markets"}),!o&&t.length>0&&(0,s.jsxs)("p",{className:"text-gray-600 mt-1",children:["Found ",t.length," markets near ",h," within ",u," miles"]})]}),(0,s.jsx)(l(),{href:(0,i.K3)("/"),className:"bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:"New Search"})]}),o?(0,s.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-green-500"})}):d?(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,s.jsx)("p",{children:d})}):0===t.length?(0,s.jsx)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded",children:(0,s.jsx)("p",{children:"No farmers markets found in your area. Try expanding your search radius or searching for a different location."})}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e,t)=>(0,s.jsx)(components_MarketCard,{market:{id:e.id||String(t),...e}},e.id||t))})]})})}},2410:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(6691),n=r.n(a),o=r(5800),l=r(3267),i=r(8416);t.Z=e=>{let{src:t,alt:r,width:a,height:c,className:d="",fill:m=!1,priority:h=!1,fallback:u="/farm-basket-logo.svg",sizes:g,style:f,...p}=e;console.log("Image component input src:",t);let x=(0,o.K3)(t);console.log("Image component final path:",x);let y=x.match(/\/find-my-farmers-market\//g);return(y&&y.length>1&&(console.error("DUPLICATE PATH DETECTED in Image component: ".concat(y.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",x)),i.BB)?(0,s.jsx)(l.Z,{src:x,alt:r,width:a,height:c,className:d,loading:h?"eager":"lazy",style:{...f,objectFit:m?"cover":void 0,position:m?"absolute":void 0,width:m?"100%":void 0,height:m?"100%":void 0},skipPathProcessing:!0}):(0,s.jsx)(n(),{src:x,alt:r,width:m?void 0:a||100,height:m?void 0:c||100,className:d,fill:m,priority:h,sizes:g,unoptimized:!0,style:f,...p})}},3267:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(5800);t.Z=e=>{let{src:t,alt:r,width:n,height:o,className:l="",loading:i="lazy",style:c,skipPathProcessing:d=!1}=e;console.log("StaticImage component input src:",t);let m=d?t:(0,a.K3)(t);console.log("StaticImage component final path:",m);let h=m.match(/\/find-my-farmers-market\//g);return h&&h.length>1&&(console.error("DUPLICATE PATH DETECTED in StaticImage component: ".concat(h.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",m)),(0,s.jsx)("img",{src:m,alt:r,width:n,height:o,className:l,loading:i,style:c})}},6454:function(e,t,r){"use strict";r.d(t,{pd:function(){return fetchMarkets}});let s="https://www.usdalocalfoodportal.com/api",a="wT29LlT8K9",buildApiUrl=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.endsWith("/")?e:"".concat(e,"/"),n="".concat(s).concat(r,"?apikey=").concat(a),o=Object.entries(t).filter(e=>{let[t,r]=e;return r}).map(e=>{let[t,r]=e;return"".concat(t,"=").concat(encodeURIComponent(r))}).join("&");return o?"".concat(n,"&").concat(o):n};async function fetchMarkets(e){try{console.log("Fetching markets with params:",e);let t=buildApiUrl("/farmersmarket",e),r="".concat(s,"/farmersmarket/?apikey=").concat(a,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20"),n="".concat(s,"/farmersmarket?apikey=").concat(a,"&zip=").concat(e.zip||"","&radius=").concat(e.radius||"20");console.log("URL Variation 1 (API key hidden):",t.replace(a,"***API_KEY***")),console.log("URL Variation 2 (API key hidden):",r.replace(a,"***API_KEY***")),console.log("URL Variation 3 (API key hidden):",n.replace(a,"***API_KEY***")),console.log("Using URL (API key hidden):",r.replace(a,"***API_KEY***"));let o=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(console.log("Response status:",o.status,o.statusText),console.log("Response headers:",Object.fromEntries([...o.headers.entries()])),!o.ok)throw Error("API responded with status ".concat(o.status));let l=await o.json();return console.log("API Response data type:",typeof l),console.log("API Response is array:",Array.isArray(l)),console.log("API Response structure:",Array.isArray(l)?"Array with ".concat(l.length," items"):Object.keys(l).join(", ")),l}catch(e){throw console.error("Error fetching markets:",e),e}}},5800:function(e,t,r){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t=e.match(/\/find-my-farmers-market\//g);t&&t.length>0&&(console.error("Input path already contains ".concat(t.length," repetitions of /find-my-farmers-market/")),console.error("Input path:",e));let r="/find-my-farmers-market";if(!r||e.includes(r)||e.includes(r.slice(1)))return e.startsWith("/")?e:"/".concat(e);let s=e.startsWith("/")?e.slice(1):e,a="".concat(r,"/").concat(s);return console.log("getAssetPath js output:",a),a}r.d(t,{K3:function(){return getAssetPath}})},8416:function(e,t,r){"use strict";r.d(t,{BB:function(){return s},sb:function(){return a}});let s=!0,a=s?"/find-my-farmers-market":""},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[176,691,971,472,744],function(){return e(e.s=2523)}),_N_E=e.O()}]);