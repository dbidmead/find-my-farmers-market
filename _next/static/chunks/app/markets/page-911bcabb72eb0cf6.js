(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[757],{2523:function(e,t,r){Promise.resolve().then(r.bind(r,7431))},7431:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return MarketsPage}});var s=r(7437),a=r(2265),l=r(4033),n=r(1396),o=r.n(n),i=r(5800),c=r(2410),components_MarketCard=e=>{let{market:t}=e,r=t.listing_name||t.marketname||t.MarketName||"Farmers Market";t.listing_desc||t.brief_desc;let a=t.location_address||[t.street||t.Address,t.city||t.City,t.state||t.State].filter(Boolean).join(", "),l=t.listing_image||"/images/market-placeholder.jpg",n="number"==typeof t.distance?"".concat(t.distance.toFixed(1)," mi"):"",d=t.location_x&&t.location_y,m=d?"https://maps.google.com/?q=".concat(t.location_y,",").concat(t.location_x):"";return(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"relative h-48",children:[l.startsWith("http")?(0,s.jsx)("img",{src:l,alt:r,className:"w-full h-full object-cover"}):(0,s.jsx)(c.Z,{src:"/images/market-placeholder.jpg",alt:r,fill:!0,className:"object-cover"}),n&&(0,s.jsx)("div",{className:"absolute top-3 right-3 bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:n})]}),(0,s.jsxs)("div",{className:"p-4 flex-grow flex flex-col",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-1 text-gray-800 line-clamp-1",children:r}),a&&(0,s.jsxs)("div",{className:"flex items-start mb-2",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 mr-1 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),(0,s.jsx)("p",{className:"text-gray-500 text-sm line-clamp-1",children:a})]}),(0,s.jsxs)("div",{className:"mt-auto pt-3 flex items-center justify-between border-t border-gray-100",children:[(0,s.jsxs)(o(),{href:(0,i.K3)("/markets/".concat(t.id)),className:"text-green-600 hover:text-green-800 font-medium text-sm inline-flex items-center",children:["View Details",(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),m&&(0,s.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:text-blue-700 text-sm",children:"Maps"})]})]})]})};function MarketsPage(){let e=(0,l.useSearchParams)(),[t,r]=(0,a.useState)([]),[n,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(null),h=(null==e?void 0:e.get("zip"))||"",u=(null==e?void 0:e.get("radius"))?parseInt((null==e?void 0:e.get("radius"))||"20"):20;return(0,a.useEffect)(()=>{(async function(){if(!h){m("ZIP code is required"),c(!1);return}try{c(!0);let e="wT29LlT8K9",t="".concat("https://www.usdalocalfoodportal.com/api","/farmersmarket/?apikey=").concat(e,"&zip=").concat(h,"&radius=").concat(u);console.log("Making direct API call to USDA API (API key hidden):",t.replace(e,"***API_KEY***"));let s=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","User-Agent":"FarmersMarketDirectory/1.0"},credentials:"omit"});if(!s.ok)throw Error("API responded with status ".concat(s.status));let a=await s.json();Array.isArray(a)?r(a):a&&a.results&&Array.isArray(a.results)?r(a.results):a&&a.data&&Array.isArray(a.data)?r(a.data):(console.error("Unexpected API response format:",a),r([])),m(null)}catch(e){console.error("Error fetching markets:",e),m("Failed to fetch farmers markets. Please try again."),r([])}finally{c(!1)}})()},[h,u]),(0,s.jsxs)("div",{className:"markets-page container mx-auto px-4 py-8",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold mb-6",children:["Farmers Markets Near ",h]}),n?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mb-4"}),(0,s.jsx)("p",{children:"Loading markets..."})]}):d?(0,s.jsxs)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6",children:[(0,s.jsx)("p",{children:d}),(0,s.jsx)(o(),{href:(0,i.K3)("/"),children:(0,s.jsx)("button",{className:"mt-4 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):0===t.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsxs)("p",{className:"mb-4",children:["No markets found near ZIP code ",h,"."]}),(0,s.jsx)(o(),{href:(0,i.K3)("/"),children:(0,s.jsx)("button",{className:"bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"Try New Search"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"mb-6",children:["Found ",t.length," markets within ",u," miles of ",h]}),(0,s.jsx)(o(),{href:(0,i.K3)("/"),children:(0,s.jsx)("button",{className:"mb-6 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded",children:"New Search"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((e,t)=>(0,s.jsx)(components_MarketCard,{market:e},t))})]})]})}},2410:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(6691),l=r.n(a),n=r(5800),o=r(3267),i=r(8416);t.Z=e=>{let{src:t,alt:r,width:a,height:c,className:d="",fill:m=!1,priority:h=!1,fallback:u="/farm-basket-logo.svg",sizes:g,style:f,...x}=e;console.log("Image component input src:",t);let p=(0,n.K3)(t);console.log("Image component final path:",p);let b=p.match(/\/find-my-farmers-market\//g);return(b&&b.length>1&&(console.error("DUPLICATE PATH DETECTED in Image component: ".concat(b.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",p)),i.BB)?(0,s.jsx)(o.Z,{src:p,alt:r,width:a,height:c,className:d,loading:h?"eager":"lazy",style:{...f,objectFit:m?"cover":void 0,position:m?"absolute":void 0,width:m?"100%":void 0,height:m?"100%":void 0},skipPathProcessing:!0}):(0,s.jsx)(l(),{src:p,alt:r,width:m?void 0:a||100,height:m?void 0:c||100,className:d,fill:m,priority:h,sizes:g,unoptimized:!0,style:f,...x})}},3267:function(e,t,r){"use strict";var s=r(7437);r(2265);var a=r(5800);t.Z=e=>{let{src:t,alt:r,width:l,height:n,className:o="",loading:i="lazy",style:c,skipPathProcessing:d=!1}=e;console.log("StaticImage component input src:",t);let m=d?t:(0,a.K3)(t);console.log("StaticImage component final path:",m);let h=m.match(/\/find-my-farmers-market\//g);return h&&h.length>1&&(console.error("DUPLICATE PATH DETECTED in StaticImage component: ".concat(h.length," repetitions of /find-my-farmers-market/")),console.error("Full path:",m)),(0,s.jsx)("img",{src:m,alt:r,width:l,height:n,className:o,loading:i,style:c})}},5800:function(e,t,r){"use strict";function getAssetPath(e){console.log("getAssetPath js input:",e);let t="/find-my-farmers-market",r=e.startsWith("/")?e:"/".concat(e);if(r.includes(t))return r;let s="".concat(t).concat(r);return console.log("getAssetPath js output:",s),s}r.d(t,{K3:function(){return getAssetPath}})},8416:function(e,t,r){"use strict";r.d(t,{BB:function(){return s},sb:function(){return a}});let s=!0,a=s?"/find-my-farmers-market":""},4033:function(e,t,r){e.exports=r(94)}},function(e){e.O(0,[176,691,971,472,744],function(){return e(e.s=2523)}),_N_E=e.O()}]);